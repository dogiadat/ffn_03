<% provide :title, @match.team1.name + " - " + @match.team2.name %>
<section id="match-section">
  <p id="league-name">
    <%= @match.league_season.name + " " + @match.league_season.year.to_s %>
  </p>
  <div id="match-info" class="well">
    <div class="team">
      <%= link_to @match.team1 do %>
        <%= image_tag @match.team1.logo.medium.url %>
      <% end %>
      <p><%= link_to @match.team1.name, @match.team1 %></p>
    </div>
    <div id="info">
      <span class="goals"><%= @match.team1_goal || "1" %></span>
      <span>:</span>
      <span class="goals"><%= @match.team2_goal || "2" %></span>
      <br/>
      <p class="label label-<%= @match.label_for_status %>">
        <%= t ".#{@match.status}" %>
      </p>
    </div>
    <div class="team">
      <%= link_to @match.team2 do %>
        <%= image_tag @match.team2.logo.medium.url %>
      <% end %>
      <p><%= link_to @match.team2.name, @match.team2 %></p>
    </div>
    <div id="start-time">
      <%= t(".start_at") + ": " %>
      <%= @match.start_time.to_s %>
    </div>
  </div>

  <ul class="nav nav-tabs">
    <li class="active">
      <a data-toggle="tab" href="#bet-odds"><%= t ".bet_odds" %></a>
    </li>
    <li>
      <a data-toggle="tab" href="#match-events"><%= t ".match_events" %></a>
    </li>
  </ul>

  <div class="tab-content">
    <div id="bet-odds" class="tab-pane fade in active">
      <table class="table table-bordered">
        <thead>
          <th><%= @match.team1.name + " " + t(".win") %></th>
          <th><%= t ".draw" %></th>
          <th><%= @match.team2.name + " " + t(".win") %></th>
        </thead>
        <tbody id="team-odds">
          <tr>
            <td><%= @match.team1_odds %></td>
            <td><%= @match.draw_odds %></td>
            <td><%= @match.team2_odds %></td>
          </tr>
      </table>
      <% if user_signed_in? && @match.start_time > Time.zone.now %>
        <%= link_to t(".make_a_bet"), "#", class: "btn btn-primary",
          id: "bet-match" %>
        <div class="make-bet-success"></div>
        <div class="hidden" id="user-bet">
          <%= form_for @user_bet, remote: true do |f| %>
            <div class="user-bet-errors"></div>
            <%= f.hidden_field :user_id, value: current_user.id %>
            <%= f.hidden_field :match_id, value: @match.id %>
            <div class="form-inline">
              <div class="form-group team1">
                <label><%= @match.team1.name %><%= t ".win" %></label>
                <%= f.radio_button :chosen, :team1 %>
              </div>
              <div class="form-group draw">
                <label><%= t ".draw" %></label>
                <%= f.radio_button :chosen, :draw %>
              </div>
              <div class="form-group team2">
                <label><%= @match.team2.name %><%= t ".win" %></label>
                <%= f.radio_button :chosen, :team2 %>
              </div>
            </div>
            <div class="form-group form-inline">
              <label><%= t ".coin" %></label>
              <%= f.number_field :coin, min: 0, max: current_user.coin,
                class: "form-control bet-coin" %>
            </div>

            <div class="form-group">
              <%= f.submit t(".make"), class: "btn btn-primary form-control" %>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>

    <div id="match-events" class="tab-pane fade">
      <% if @match.not_started_yet? %>
        <p><%= t ".inform_match_not_started_yet" %></p>
      <% else %>
        <table class="table table-striped table-bordered">
          <thead>
            <th id="header-time"><%= t ".header_time" %></th>
            <th id="header-event"><%= t ".header_events" %></th>
          </thead>
          <tbody>
            <% @match.match_events.each do |event| %>
              <tr>
                <td class="time"><%= event.time %></td>
                <td class="event"><%= event.content %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% end %>
    </div>
  </div>
</section>
